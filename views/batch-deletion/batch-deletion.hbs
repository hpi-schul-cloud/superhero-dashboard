{{#extend "lib/loggedin"}}

  {{#content "styles" mode="append"}}
    <link rel="stylesheet" href="/styles/batch-deletion/batch-deletion.css" />
  {{/content}}
  {{#content "scripts" mode="append"}}
    <script
      src="/scripts/batch-deletion.js"
      type="text/javascript"
      defer
    ></script>
  {{/content}}

  {{#content "page"}}
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-12">
          <form id="batchDeletionFileUploadForm" class="file-input-container">
            <label for="file">Lade hier die Datei mit Nutzern hoch, die gelöscht
              werden sollen:</label>
            <div class="file-input">
              <input
                type="file"
                name="file"
                id="file"
                accept=".csv"
                class="btn btn-secondary"
                required
              />
              <input
                type="submit"
                value="Datei hochladen"
                class="btn btn-primary"
              />
            </div>
          </form>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <ul class="batch-list">
            {{#each batches}}
              <li class="batch-list-item">
                <div class="batch-header">
                  <div>
                    <h5>Löschung vom {{this.createdAt}} Uhr</h5>
                    <span>
                      {{this.overallCount}}
                      insgesamt -
                      {{this.studentCount}}
                      Schüler,
                      {{this.teacherCount}}
                      Lehrer,
                      {{this.adminCount}}
                      Admins
                    </span>
                  </div>
                  <div class="actions">
                    {{#ifneq this.status "created"}}
                      <span>status</span>
                    {{else}}
                      <button class="btn btn-primary btn-thin">
                        Löschen
                      </button>
                    {{/ifneq}}
                    <button class="btn-icon" onclick="toggleDetails('details-section-{{this.id}}')">
                      <i class="fa fa-chevron-down"></i>
                    </button>
                  </div>
                </div>
                <div id="details-section-{{this.id}}" class="details-section hidden">
                  <h3>Details</h3>

                  <p><span class="pending">{{this.pending}}</span> Pending</p>
                  <pre id="pending-ids" class="id-list">{{#each this.pendingIds}}{{this}},{{/each}}</pre>

                  <p><span class="deleted">{{this.deleted}}</span> Deleted</p>
                  <pre id="deleted-ids" class="id-list">{{#each this.deletedIds}}{{this}},{{/each}}</pre>

                  <p><span class="failed">{{this.failed}}</span> Failed</p>
                  <pre id="failed-ids" class="id-list">{{#each this.failedIds}}{{this}},{{/each}}</pre>

                  <button onclick="copyToClipboard('pending-ids')">Copy Pending IDs</button>
                  <button onclick="copyToClipboard('deleted-ids')">Copy Deleted IDs</button>
                  <button onclick="copyToClipboard('failed-ids')">Copy Failed IDs</button>
                </div>
              </li>
            {{/each}}
          </ul>
        </div>
      </div>
    </div>
  {{/content}}

{{/extend}}